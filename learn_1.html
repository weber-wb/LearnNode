<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Learn Node</title>
</head>
<body>

    
    <!-- 
        安装Node.js , 安装完成在Windows环境下, 打开命令提示符进行输入  node -v , 安装正确显示版本号

        在开始学习Node.js前，我们先认识一下 npm , npm其实是Node.js的包管理工具 (package manager) , npm 已经在 node.js 安装的时候顺带安装好了, 同上输入 npm -v 可查看当前版本

     -->

    <script>

        // Node.js
        (function(){        // hello.js
            'use strict'
            var s = 'Hello';
            function greet(name){
                console.log(`${s}, ${name}!`);
            };
            module.exports = greet;
        });
        // 函数 greet() 是我们在 hello 模块定义的, "module.exports=greet" 这行代码意思把函数greet作为模块的输出暴露出去, 这样其他模块就可以使用greet函数
        // 如何使用 hello 模块中的 greet 函数? 编写一个main.js文件

        (function(){
            'use strict'
            var greet = require('./hello');         // 使用Node提供的 require 函数： 引入 hello 模块 , 不要忘了写相对目录
            var s = 'Michael';
            greet(s);       // Hello, Michael!
        })
        // 引入的模块作为变量保存在 greet 变量中, 那 greet 变量到底是什么东东? 其实变量 greet 就是在 hello.js 中我们用 "module.exports=greet;" 输出的 greet 函数

        
        // Common.JS 规范
        // 这种模块加载机制被称为 Common.JS 规范 , 在这个规范下 , 每个.js文件都是一个模块, 它们内部各自使用的变量名和函数名都互不冲突
        // 一个模块想要对外暴露变量（函数也是变量）, 可以用 "module.exports = variable;" , 输出的变量可以是任意对象、函数、数组等等
        // 一个模块想要引用其他模块暴露的变量 , 可以用 "var ref = require('module_name');" , 就拿到了引用模块的变量。 引用的对象具体是什么 , 取决于引用的模块输出的对象

        // 其实要实现 "模块" 这个功能，并不需要语法层面的支持。Node.js 也并不会增加任何的 JavaScript 语法。实现 "模块" 功能的奥妙就在于 JavaScript 是一种函数式编程语言，它支持闭包
        // 如果我们把一段JavaScript代码用一个函数包装起来，这段代码的所有 "全局变量" 就变成了函数内部的 局部变量


        // 如果要输出一个键值对象{} , 可以利用 exports 这个已经存在的空对象 {} , 并继续在上面添加新的键值：
        // 如果要输出一个数组或函数 ， 必须直接对 module.exports 对象赋值
        // 直接对module.exports赋值，可以应对任何情况：
        // module.exports = {
        //     foo: function(){
        //         return 'foo';
        //     }
        // };
        // 或者：
        // module.exports = function(){ return 'foo'; }
        
        // 最终，强烈建议使用 "module.exports = xxx " 的方式输出模块变量，这样仅需记忆一种方法：


    </script>
    
</body>
</html>